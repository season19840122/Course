# Vite2 项目工程化和原理剖析

## 第1节 Vite2 插件开发实战

#### 知识点

> Vite 需要 [Node.js](https://nodejs.org/en/) 版本 >= 12.0.0。
>
> 提供开箱即用的功能：
>
> ts

**安装**

```javascript
// Vite lastest v 2.6.10 已经变成下面这句代码了
npm init vitejs/@lastest
```
**index.html**

```html
<script type="module" src="/src/main.js"></script>
```
**App.vue**

```vue
<div :class="$style.logo"> // 渲染后的 name 带 hash
/**
 * module 的好处是:
 * 选择器的优先级不会发生变化；
 * 渲染后 name 带 hash 不会冲突；
 * 模块化的 css 可以独立出去，但是命名规则遵循 App.module.css
 */
<style module>
.logo {
......
}
</style>
```

```javascript
// 导入全局 CSS 的方法
// 在入口 main.js 里导入
import 'index.css'

// 导入 Module CSS 的方法
// 需要一个模块名来引入
import classes from '@/App.module.css'

// 调用
<div :class="classes.logo">
```

使用 Postcss 插件

```javascript
// 1. 在 root 目录下新增 postcss.config.js
// 2. 安装 Autoprefixer
npm i autoprefixer -D
```

使用 Mock 数据

```JavaScript
// 线上 JSON 数据
export default defineConfig({
  server: {
    proxy: {
      "/api": {
        target: "http://jsonplaceholder.typicode.com",
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, ""),
      },
    },
  },
});

// or
// 自己模拟数据
npm install mock -S
npm install vite-plugin-mock -D

```



播放进度 47'33'' 

**为什么快？**

- `<script type="module" src="/src/main.js"></script>` 

  浏览器直接引用 ES Module 不需要打包了

  按需加载，无需打包 

* 

**P.S**

```javascript
// emmet
w200+h200
// 安装完 npm 包后需要重新项目

```


------



## 第2节 Vite原理剖析手写实现

#### 知识点

**Vue 设计思想：**

1. 数据驱动应用；

2. MVVM模式的践行者

**MVVM 框架三要素：响应式、模板引擎及其渲染**；

definedProperty

---

**Reference：**

[Vite](https://cn.vitejs.dev/guide/)

[Typescript](https://www.typescriptlang.org/)

[JSONPlaceholder](http://jsonplaceholder.typicode.com/)

[vite-plugin-mock](https://github.com/anncwb/vite-plugin-mock)

